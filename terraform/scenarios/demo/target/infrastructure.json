{
    "context": {
      "global": {
        "environment"           : "target",
        "deployment"            : "${ deployment }",
        "trust_security_group"  : true
      },
      "aws": {
        "profile_name" : "${ aws_profile }",
        "ec2": {
          "enabled"            : true,
          "public_subnet"                 : "172.18.0.0/24",
          "public_app_network"            : "172.19.0.0/16",
          "public_app_subnet"             : "172.19.0.0/24",
          "private_network"               : "172.16.0.0/16",
          "private_subnet"                : "172.16.100.0/24",
          "private_nat_subnet"            : "172.16.10.0/24",
          "private_app_network"           : "172.17.0.0/16",
          "private_app_subnet"            : "172.17.100.0/24",
          "private_app_nat_subnet"        : "172.17.10.0/24",
          "instances": [
            {
              "name"                      : "target-public-1",
              "public"                    : true,
              "role"                      : "default",
              "instance_type"             : "t2.micro",
              "ami_name"                  : "ubuntu_focal",
              "tags": {
                "ssm_deploy_lacework"              : "true",
                "ssm_deploy_docker"                : "true",
                "ssm_deploy_secret_ssh_private"    : "true",
                "ssm_exec_docker_log4shell_target" : "true"
              },
              "user_data"        : null,
              "user_data_base64" : null
            },
            {
              "name"                      : "target-public-2",
              "public"                    : true,
              "role"                      : "default",
              "instance_type"             : "t2.micro",
              "ami_name"                  : "ubuntu_focal",
              "tags": {
                "ssm_deploy_lacework"          : "true",
                "ssm_deploy_secret_ssh_public" : "true",
                "ssm_connect_oast_host"        : "true"
              },
              "user_data"        : null,
              "user_data_base64" : null
            },
            {
              "name"                      : "target-app-public-1",
              "public"                    : true,
              "role"                      : "app",
              "instance_type"             : "t2.micro",
              "ami_name"                  : "ubuntu_focal",
              "tags": {
                "ssm_deploy_lacework"          : "true"
              },
              "user_data"        : null,
              "user_data_base64" : null
            }
          ]
        },
        "eks": {
          "enabled"      : true,
          "cluster_name" : "target-cluster"
        },
        "ssm": {
          "enabled"                        : true,
          "deploy_git"                     : true,
          "deploy_docker"                  : true,
          "deploy_inspector_agent"         : true,
          "deploy_lacework_agent"          : true,
          "deploy_lacework_syscall_config" : true
        }
      },
      "lacework": {
        "server_url"   : "${ lacework_server_url }",
        "account_name" : "${ lacework_account_name }",
        "aws_audit_config": {
          "enabled" : true
        },
        "gcp_audit_config": {
          "project_id" : "${ gcp_lacework_project }",
          "enabled"    : false
        },
        "custom_policy": {
          "enabled" : true
        },
        "agent": {
          "enabled" : true,

          "kubernetes": {
            "enabled" : true,
            "proxy_scanner": {
              "enabled" : true
            },
            "daemonset": {
              "enabled"        : true,
              "syscall_config_path" : "${ syscall_config_path }"
            },
            "compliance": {
              "enabled" : true
            },
            "eks_audit_logs": {
              "enabled" : true
            },
            "admission_controller   ": {
              "enabled" : true
            }
          }
        },
        "aws_agentless": {
          "enabled" : true
        },
        "gcp_agentless": {
          "enabled" : false
        },
        "alerts": {
          "enabled" : true,
          "slack": {
            "enabled"   : true,
            "api_token" : "${ slack_token }"
          },
          "jira": {
            "enabled"           : true,
            "cloud_url"         : "${ jira_cloud_url }",
            "cloud_username"    : "${ jira_cloud_username }",
            "cloud_api_token"   : "${ jira_cloud_api_token }",
            "cloud_project_key" : "${ jira_cloud_project_key }",
            "cloud_issue_type"  : "${ jira_cloud_issue_type }"
          }
        }
      }
    }
  }