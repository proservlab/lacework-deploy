# count of aws violation but compliance type
select EVAL_GUID, REC_ID, COUNT(VIOLATIONS) from PRODN_CDB_LWPS_EBB48686AFFC845CBF5EB689E4214172007CE32A5E02177C7CE.AWS_CFG_INTERNAL.COMPLIANCE_EVAL_DETAILS_T GROUP BY EVAL_GUID, REC_ID, VIOLATIONS;

# aws resource summary
select * from PRODN_CDB_LWPS_EBB48686AFFC845CBF5EB689E4214172007CE32A5E02177C7CE.AWS_CFG_INTERNAL.CONFIG_SNAPSHOT_DETAILS_T;

# discovered vulns
select * from PRODN_CDB_LWPS_EBB48686AFFC845CBF5EB689E4214172007CE32A5E02177C7CE.VULN_INTERNAL.HOST_EVAL_OBSERVATION_T;

# observed cli execution
select * from "PRODN_CDB_LWPS_EBB48686AFFC845CBF5EB689E4214172007CE32A5E02177C7CE"."PUBLIC"."CMDLINE_T" LIMIT 10;

# observed connections with source destination and bytes transferred
select * from "PRODN_CDB_LWPS_EBB48686AFFC845CBF5EB689E4214172007CE32A5E02177C7CE"."PUBLIC"."CONN_DETAILS_T" LIMIT 10;

# container details (image env etc)
SELECT * FROM "PRODN_CDB_LWPS_EBB48686AFFC845CBF5EB689E4214172007CE32A5E02177C7CE"."PUBLIC"."CONTAINER_T"

# dns
SELECT * FROM "PRODN_CDB_LWPS_EBB48686AFFC845CBF5EB689E4214172007CE32A5E02177C7CE"."PUBLIC"."DNS_T" LIMIT 10;

# dns errors
SELECT * FROM "PRODN_CDB_LWPS_EBB48686AFFC845CBF5EB689E4214172007CE32A5E02177C7CE"."PUBLIC"."DNS_ERROR_T" LIMIT 10;

# machine details with env
SELECT * FROM "PRODN_CDB_LWPS_EBB48686AFFC845CBF5EB689E4214172007CE32A5E02177C7CE"."PUBLIC"."MACHINE_DETAILS_T" LIMIT 10;

# discovered listening endpoints
SELECT * FROM "PRODN_CDB_LWPS_EBB48686AFFC845CBF5EB689E4214172007CE32A5E02177C7CE"."PUBLIC"."LISTENING_EP_T" LIMIT 10;

# process details including username and launch args
SELECT * FROM "PRODN_CDB_LWPS_EBB48686AFFC845CBF5EB689E4214172007CE32A5E02177C7CE"."PUBLIC"."PROCESS_DETAILS_T" LIMIT 10;

# user login details (e.g. via ssh)
SELECT * FROM "PRODN_CDB_LWPS_EBB48686AFFC845CBF5EB689E4214172007CE32A5E02177C7CE"."PUBLIC"."USER_LOGIN_T" LIMIT 10;

# === INTERNAL_PORTAL ROLE ===

# high-level compliance for all customers
SELECT * FROM "PRODN_LACEWORK_BI"."EXPORT_DATA"."AWS_COMPLIANCE_T"

# list of events related to bad ips
SELECT * FROM "PRODN_LACEWORK_BI"."PUBLIC"."INVESTIGATION_41651_BAD_IPS";

# list of events related to user names
SELECT * FROM "PRODN_LACEWORK_BI"."PUBLIC"."INVESTIGATION_41651_USER_NAME" LIMIT 1;

# all customer compliance reports view
SELECT * FROM "PRODN_LACEWORK_BI"."PUBLIC"."COMPLIANCE_REPORTS_VIEW" LIMIT 10;

# all customer compliance resource view
SELECT * FROM "PRODN_LACEWORK_BI"."PUBLIC"."APPD_COMPLIANCE_RESOURCE_VIEW" LIMIT 1;

# specific appd compliance report request
SELECT * FROM "PRODN_LACEWORK_BI"."PUBLIC"."APPD_COMPLIANCE_VIEW" LIMIT 1;

# specific complinace report on gcp for airbnb
SELECT * FROM "PRODN_LACEWORK_BI"."PUBLIC"."CUSTOM_COMPLIANCE_REPORT_AIRBNB" LIMIT 1;